<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Advent Of Cyber 2022 (TryHackMe)</title>
<meta name="generator" content="Org mode" />
<link rel='stylesheet' href='/css/default.css' />
<link rel='stylesheet' href='/css/source-code.css' />
</head>
<body>
<div id="preamble" class="status">
<h1 id='site-name'>Bryan Rinders</h1>
<div id='menu'>
  <a href='/'>Home</a>
  <a href='/ctf-index.html'>CTF WriteUps</a>
  <a href='/emacs-index.html'>Emacs</a>
  <a href='/linux-index.html'>Linux Tutorials</a>
  <a href='https://gitlab.com/bryos/dotfiles' target='_blank'>Dotfiles</a>
</div>
<br><hr>
</div>
<div id="content">
<h1 class="title">Advent Of Cyber 2022 (TryHackMe)</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#Day-1-Frameworks">Day 1 Frameworks</a></li>
<li><a href="#Day-2-Log-Analysis">Day 2 Log Analysis</a></li>
<li><a href="#Day-3-OSINT">Day 3 OSINT</a></li>
<li><a href="#Day-4-Scanning">Day 4 Scanning</a></li>
<li><a href="#Day-5-Brute-Forcing">Day 5 Brute Forcing</a></li>
<li><a href="#Day-6-Email-Analysis">Day 6 Email Analysis</a></li>
<li><a href="#Day-7-Cyberchef">Day 7 Cyberchef</a></li>
<li><a href="#Day-8-Smart-Contracts">Day 8 Smart Contracts</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgbb96362" class="outline-2">
<h2 id="Introduction"><a href="#Introduction">Introduction</a></h2>
<div class="outline-text-2" id="text-Introduction">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2022-12-07 Wed]</span></span>
</p>

<p>
This is a write up for the 2022 version of TryHackMe's Advent Of
Cyber. Join the room <a href="https://tryhackme.com/room/adventofcyber4">here</a>.
</p>
</div>
</div>

<div id="outline-container-orgfd8b55c" class="outline-2">
<h2 id="Day-1-Frameworks"><a href="#Day-1-Frameworks">Day 1 Frameworks</a></h2>
<div class="outline-text-2" id="text-Day-1-Frameworks">
</div>
<div id="outline-container-orgf7426f9" class="outline-3">
<h3 id="Day-1-Puzzle-1"><a href="#Day-1-Puzzle-1">Puzzle 1</a></h3>
<div class="outline-text-3" id="text-Day-1-Puzzle-1">
<ol class="org-ol">
<li>Reconnaissance</li>
<li>Weaponization</li>
<li>Delivery</li>
<li>Social Engineering</li>
<li>Exploitation</li>
<li>Persistence</li>
<li>Defence Evasion</li>
<li>Command &amp; Control</li>
</ol>
</div>
</div>

<div id="outline-container-org35a6c4b" class="outline-3">
<h3 id="Day-1-Puzzle-2"><a href="#Day-1-Puzzle-2">Puzzle 2</a></h3>
<div class="outline-text-3" id="text-Day-1-Puzzle-2">
<ol class="org-ol">
<li>Pivoting</li>
<li>Discovery</li>
<li>Priviledge Escalation</li>
<li>Execution</li>
<li>Credential Access</li>
<li>Lateral Movement</li>
</ol>
</div>
</div>

<div id="outline-container-orgb26f860" class="outline-3">
<h3 id="Day-1-Puzzle-3"><a href="#Day-1-Puzzle-3">Puzzle 3</a></h3>
<div class="outline-text-3" id="text-Day-1-Puzzle-3">
<ol class="org-ol">
<li>Access</li>
<li>Collection</li>
<li>Exfiltration</li>
<li>Impact</li>
<li>Objectivication</li>
</ol>
</div>
</div>

<div id="outline-container-orgca560a9" class="outline-3">
<h3 id="Day-1-Answers"><a href="#Day-1-Answers">Answers</a></h3>
<div class="outline-text-3" id="text-Day-1-Answers">
<p>
Who is the adversary that attacked Santa's network this year?
</p>

<pre class="example">
The Bandit Yeti
</pre>

<p>
What's the flag that they left behind?
</p>

<pre class="example">
THM{IT'S A Y3T1 CHR1$TMA$}
</pre>
</div>
</div>
</div>

<div id="outline-container-orga001464" class="outline-2">
<h2 id="Day-2-Log-Analysis"><a href="#Day-2-Log-Analysis">Day 2 Log Analysis</a></h2>
<div class="outline-text-2" id="text-Day-2-Log-Analysis">
<p>
Use the ls command to list the files present in the current directory. How many log files are present?
</p>

<div class="org-src-container">
<pre class="src src-sh">ls *.log | wc -l
</pre>
</div>

<p>
Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?
</p>

<div class="org-src-container">
<pre class="src src-sh">ls *.log
</pre>
</div>

<p>
On what day was Santa's naughty and nice list stolen?
</p>

<div class="org-src-container">
<pre class="src src-sh">grep <span class="org-string">"santaslist.txt"</span> webserver.log
</pre>
</div>

<p>
November 18 2022 is a Friday.
</p>

<pre class="example">
Friday
</pre>

<p>
What is the IP address of the attacker?
</p>

<p>
From the grep of the previous question the IP is:
</p>

<pre class="example">
10.10.249.191
</pre>

<p>
What is the name of the important list that the attacker stole from Santa?
</p>

<p>
Again from the grep of the previous question the file name is:
</p>

<pre class="example">
santaslist.txt
</pre>

<p>
Look through the log files for the flag. The format of the flag is: THM{}
</p>

<div class="org-src-container">
<pre class="src src-sh">grep THM SSDH.log
</pre>
</div>
</div>
</div>

<div id="outline-container-org19f2d5a" class="outline-2">
<h2 id="Day-3-OSINT"><a href="#Day-3-OSINT">Day 3 OSINT</a></h2>
<div class="outline-text-2" id="text-Day-3-OSINT">
<p>
What is the name of the Registrar for the domain santagift.shop?
</p>

<p>
Go to <a href="https://who.is/whois/github.com">https://who.is/whois/github.com</a> and search for <code>santagift.shop</code>. The name of the registra is
</p>

<pre class="example">
NAMECHEAP.INC
</pre>

<p>
Find the website's source code (repository) on github.com and open the file containing sensitive credentials. Can you find the flag?
</p>

<p>
The url to the source code of the webshop is:
</p>

<pre class="example">
https://github.com/muhammadthm/SantaGiftShop
</pre>

<p>
Clone the repository and grep for <code>THM</code> to easily find the flag.
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone https://github.com/muhammadthm/SantaGiftShop.git
<span class="org-builtin">cd</span> SantaGiftShop
grep <span class="org-string">'THM'</span> **/*
</pre>
</div>

<p>
What is the name of the file containing passwords?
</p>

<div class="org-src-container">
<pre class="src src-sh">grep password **/*
</pre>
</div>

<p>
Among the output you'll find the answer:
</p>

<pre class="example">
config.php
</pre>

<p>
What is the name of the QA server associated with the website?
</p>

<div class="org-src-container">
<pre class="src src-sh">grep QA **/*
</pre>
</div>

<p>
Among the output you'll find the url to the QA website:
</p>

<pre class="example">
qa.santagift.shop
</pre>

<p>
What is the DB_PASSWORD that is being reused between the QA and PROD environments?
</p>

<div class="org-src-container">
<pre class="src src-sh">grep <span class="org-string">'DB_PASSWORD'</span> **/*
</pre>
</div>

<p>
The password is:
</p>

<pre class="example">
s@nta2022
</pre>
</div>
</div>

<div id="outline-container-org70329f2" class="outline-2">
<h2 id="Day-4-Scanning"><a href="#Day-4-Scanning">Day 4 Scanning</a></h2>
<div class="outline-text-2" id="text-Day-4-Scanning">
</div>
</div>
<div id="outline-container-orge6f9c3a" class="outline-2">
<h2 id="Day-5-Brute-Forcing"><a href="#Day-5-Brute-Forcing">Day 5 Brute Forcing</a></h2>
<div class="outline-text-2" id="text-Day-5-Brute-Forcing">
<p>
Use Hydra to find the VNC password of the target with IP address
<b>MACHINE_IP</b>. What is the password?
</p>

<div class="org-src-container">
<pre class="src src-sh">hydra -P /usr/share/wordlists/rockyou.txt MACHINE_IP vnc
</pre>
</div>

<p>
Using a VNC client on the AttackBox, connect to the target of IP
address MACHINE_IP. What is the flag written on the targetâ€™s screen?
</p>

<p>
When using an attackbox open Remmina from Application &gt; Internet &gt;
Remmina. Click cancel when asked to unlock your keyring. Then select
the VNC protocol on the top left corner and type the <b>MACHINE_IP</b> in
the search bar. Use the password found in the previous question when
asked for a password. Finally you'll see a screen with the flag.
</p>

<pre class="example">
THM{I_SEE_YOUR_SCREEN}
</pre>
</div>
</div>

<div id="outline-container-org4400c6c" class="outline-2">
<h2 id="Day-6-Email-Analysis"><a href="#Day-6-Email-Analysis">Day 6 Email Analysis</a></h2>
<div class="outline-text-2" id="text-Day-6-Email-Analysis">
<ol class="org-ol">
<li>What is the email address of the sender?</li>
</ol>

<p>
Open the <code>Urgent:.eml</code> with any text editor.
</p>
<pre class="example">
chief.elf@santaclaus.thm
</pre>

<ol class="org-ol">
<li>What is the return address?</li>
</ol>

<pre class="example">
murphy.evident@bandityeti.thm
</pre>

<ol class="org-ol">
<li>On whose behalf was the email sent?</li>
</ol>

<pre class="example">
chief elf
</pre>

<ol class="org-ol">
<li>What is the X-spam score?</li>
</ol>

<pre class="example">
3
</pre>

<ol class="org-ol">
<li>What is hidden in the value of the Message-ID field?</li>
</ol>

<p>
Decode the message with a base 64 decoder.
</p>
<pre class="example">
AoC2022_Email_Analysis
</pre>

<ol class="org-ol">
<li>Visit the email reputation check website provided in the task. What
is the reputation result of the sender's email address?</li>
</ol>

<p>
Go to <a href="https://emailrep.io/">https://emailrep.io/</a> and search for <code>chief.elf@santaclaus.thm</code>
</p>
<pre class="example">
Risky
</pre>

<ol class="org-ol">
<li>Check the attachments. What is the filename of the attachment?</li>
</ol>

<pre class="example">
Division_of_labour-Load_share_plan.doc
</pre>

<ol class="org-ol">
<li>What is the hash value of the attachment?</li>
</ol>

<div class="org-src-container">
<pre class="src src-sh">emlAnalyzer -i Urgent<span class="org-string">\:</span>.eml --extract-all
<span class="org-builtin">cd</span> eml-attachments
sha256sum Division_of_labour-Load_share_plan.doc
</pre>
</div>

<ol class="org-ol">
<li>Visit the Virus Total website and use the hash value to
search. Navigate to the behaviour section. What is the second
tactic marked in the Mitre ATT&amp;CK section?</li>
</ol>

<p>
Go to <a href="https://www.virustotal.com/gui/home/upload">https://www.virustotal.com/gui/home/upload</a> and search for the
hash found in the previous question. Navigate to the behaviour tab and
look for the Mitre section. The second tactic is:
</p>
<pre class="example">
defense evasion
</pre>

<ol class="org-ol">
<li>Visit the InQuest website and use the hash value to search. What
is the subcategory of the file?</li>
</ol>

<p>
Go to <a href="https://labs.inquest.net/">https://labs.inquest.net/</a> and again search the hash found
previously. Click the full page results. The sub-category is:
</p>
<pre class="example">
macro_hunter
</pre>
</div>
</div>

<div id="outline-container-org3b0fee2" class="outline-2">
<h2 id="Day-7-Cyberchef"><a href="#Day-7-Cyberchef">Day 7 Cyberchef</a></h2>
<div class="outline-text-2" id="text-Day-7-Cyberchef">
<p>
Before answering any of the questions, open firefox and click the
bookmark of cyberchef. Then go through all the 11 steps as explained
in the intro.
</p>

<p>
What is the version of CyberChef found in the attached VM?
</p>

<p>
You can find the version number in the url.
</p>

<pre class="example">
9.49.0
</pre>

<p>
How many recipes were used to extract URLs from the malicious doc?
</p>

<pre class="example">
10
</pre>

<p>
We found a URL that was downloading a suspicious file; what is the name of that malware?
</p>

<pre class="example">
mysterygift.exe
</pre>

<p>
What is the last defanged URL of the bandityeti domain found in the last step?
</p>

<pre class="example">
hxxps[://]cdn[.]bandityeti[.]THM/files/index/
</pre>

<p>
What is the ticket found in one of the domains? (Format: Domain/&lt;GOLDEN_FLAG&gt;)
</p>

<pre class="example">
THM_MYSTERY_FLAG
</pre>
</div>
</div>

<div id="outline-container-org057e808" class="outline-2">
<h2 id="Day-8-Smart-Contracts"><a href="#Day-8-Smart-Contracts">Day 8 Smart Contracts</a></h2>
<div class="outline-text-2" id="text-Day-8-Smart-Contracts">
</div>
</div>
</div>
<div id="postamble" class="status">
<br><br>
<div style='text-align: center;'>
  If something is not working, please create an issue
  <a href='https://gitlab.com/bryanrinders/bryanrinders.xyz/-/issues'>here</a>.
</div>
<br><hr/>
<footer>
  <div class='copyright-container'>
    <div class='copyright'>
      Copyright &copy; 2022-2024 Bryan Rinders some rights reserved
      <br><br>
      This page is available under a
      <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'>
        CC-BY 4.0
      </a> licence.
    </div>
  </div>
  <br>
  <div class='generated'>
    Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="https://orgmode.org">Org</a> mode 9.3) on <a href='https://www.gnu.org'>GNU</a>+<a href='https://www.kernel.org/'>Linux</a>
  </div>
</footer>
</div>
</body>
</html>
