<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Safely Remove External Hard Drives From The CLI</title>
<meta name="generator" content="Org mode" />
<link rel='stylesheet' href='/css/default.css' />
<link rel='stylesheet' href='/css/source-code.css' />
</head>
<body>
<div id="preamble" class="status">

<h1 id='site-name'>
  <tt>
    <span class='org-br-prompt'>(</span><span class='org-keyword'>setq</span>
    <span class='org-variable-name'>plaintext</span>
    'everywhere<span class='org-br-prompt'>)</span>
  </tt>
</h1>
<div id='menu'>
  <a href='/'>Home</a>
  <a href='/ctf/index.html'>CTF WriteUps</a>
  <a href='/emacs/index.html'>Emacs</a>
  <a href='/linux/index.html'>Linux Tutorials</a>
  <a href='https://gitlab.com/bryos/dotfiles' target='_blank'>Dotfiles</a>
</div>
<br><hr>
</div>
<div id="content">
<h1 class="title">Safely Remove External Hard Drives From The CLI</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#udisks">2. Udisks</a></li>
<li><a href="#sources">3. Sources</a></li>
</ul>
</div>
</div>

<div id="outline-container-org52d3f80" class="outline-2">
<h2 id="introduction"><span class="section-number-2">1</span> <a href="#introduction">Introduction</a></h2>
<div class="outline-text-2" id="text-introduction">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2023-10-22 Sun]</span></span>
</p>

<p>
You might have noticed that after
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo umount /dev/sdX
</pre>
</div>

<p>
a external hard drive is still making noise and appears to be in use
by the OS. This is because rotating hard disks require a few extra
commands before they can be safely unplugged, <a href="https://www.freedesktop.org/wiki/Software/udisks/">udisks</a> is a CLI tool
that can be used for this purpose.
</p>
</div>
</div>

<div id="outline-container-orge5b6fa6" class="outline-2">
<h2 id="udisks"><span class="section-number-2">2</span> <a href="#udisks">Udisks</a></h2>
<div class="outline-text-2" id="text-udisks">
<p>
To unmount the external harddrive:
</p>

<div class="org-src-container">
<pre class="src src-sh">udisksctl unmount -b /dev/sdXn
</pre>
</div>

<p>
followed by:
</p>

<div class="org-src-container">
<pre class="src src-sh">udisksctl power-off -b /dev/sdX
</pre>
</div>

<p>
The commands result in a graceful power down of the spinning hard
drive; after which it can be safely unplugged.
</p>

<p>
Note that the last command turns off all the power to the specific
port and if you use a usb hub that might cause other devices connected
to that hub to lose connection, check the <code>udisksctl</code> man page for
more information on this.
</p>
</div>
</div>

<div id="outline-container-org4c06241" class="outline-2">
<h2 id="sources"><span class="section-number-2">3</span> <a href="#sources">Sources</a></h2>
<div class="outline-text-2" id="text-sources">
<ul class="org-ul">
<li><a href="https://unix.stackexchange.com/questions/354138/safest-way-to-remove-usb-drive-on-linux">https://unix.stackexchange.com/questions/354138/safest-way-to-remove-usb-drive-on-linux</a></li>
<li><a href="https://stackoverflow.com/questions/13224509/linux-ubuntu-safely-remove-a-usb-flash-disk-via-the-command-line">https://stackoverflow.com/questions/13224509/linux-ubuntu-safely-remove-a-usb-flash-disk-via-the-command-line</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<br><br>
<div style='text-align: center;'>
  If something is not working, please create an issue
  <a href='https://gitlab.com/bryanrinders/bryanrinders.xyz/-/issues'>here</a>.
</div>
<br><hr/>
<footer>
  <div class='copyright-container'>
    <div class='copyright'>
      Copyright &copy; 2022-2024 Bryan Rinders some rights reserved
      <br><br>
      This page is available under a
      <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'>
        CC-BY 4.0
      </a> licence.
    </div>
  </div>
  <br>
  <div class='generated'>
    Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="https://orgmode.org">Org</a> mode 9.3) on <a href='https://www.gnu.org'>GNU</a>+<a href='https://www.kernel.org/'>Linux</a>
  </div>
</footer>
</div>
</body>
</html>
